<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Job Card Management</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .job-card {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            border: 1px solid #ccc;
            padding: 20px;
            background: white;
        }
        .job-card h1 {
            text-align: center;
            font-size: 24px;
            margin-bottom: 20px;
            border-bottom: 1px solid #000;
            padding-bottom: 10px;
        }
        .job-card .grid-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 15px;
        }
        .job-card .field {
            margin-bottom: 8px;
        }
        .job-card .field label {
            font-weight: bold;
            display: inline-block;
            min-width: 150px;
        }
        .job-card .body-report {
            margin: 20px 0;
        }
        .job-card .body-report img {
            max-width: 100%;
            height: auto;
            border: 1px solid #ddd;
        }
        .job-card table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        .job-card table, .job-card th, .job-card td {
            border: 1px solid #ddd;
        }
        .job-card th, .job-card td {
            padding: 8px;
            text-align: left;
        }
        .job-card .signature-box {
            margin-top: 30px;
            border-top: 1px solid #000;
            width: 300px;
            padding-top: 5px;
        }
        .job-card .footer {
            margin-top: 20px;
            font-size: 12px;
            text-align: center;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">

    <!-- Sidebar -->
    <div id="sidebar" class="fixed inset-y-0 left-0 w-64 bg-white shadow-xl z-50 
      transform -translate-x-full lg:translate-x-0 
      transition-transform duration-300 ease-in-out">

      <!-- Logo -->
      <div class="flex items-center justify-center h-20 bg-white">
        <div class="w-44 h-10 rounded-lg flex items-center justify-center">
          <img src="SV0KVFfZjW2ETXN.png" alt="">
        </div>
      </div>

      <!-- Close Button (mobile only) -->
      <div class="lg:hidden flex justify-end px-4 py-2">
        <button id="sidebarClose" class="text-black text-xl hover:text-red-400">
          <i class="fas fa-times"></i>
        </button>
      </div>

      <!-- Nav -->
       <nav class="mt-4 px-4 overflow-y-auto h-[calc(100vh-10rem)]">
        <div class="space-y-2">
          <a href="Dashboard.html" class="sidebar-link flex items-center px-4 py-3 text-gray-800 bg-white hover:bg-[#7F55B1] hover:text-white rounded-lg transition-colors group">
            <i class="fas fa-home mr-3 text-gray-400 group-hover:text-white"></i>
            Dashboard
          </a>
          <a href="Customer Management.html" class="sidebar-link flex items-center px-4 py-3 text-gray-800 bg-white hover:bg-[#7F55B1] hover:text-white rounded-lg transition-colors group">
            <i class="fas fa-users mr-3 text-gray-400 group-hover:text-white"></i>
            Customer Management
          </a>
          <a href="vehicle-management.html" class="sidebar-link flex items-center px-4 py-3 text-gray-800 bg-white hover:bg-[#7F55B1] hover:text-white rounded-lg transition-colors group">
            <i class="fas fa-chart-bar mr-3 text-gray-400 group-hover:text-white"></i>
            Vehicle Management
          </a>
          <a href="Job Card Managemen.html" class="sidebar-link flex items-center px-4 py-3 text-gray-100 bg-[#7F55B1] hover:text-white rounded-lg transition-colors group">
            <i class="fas fa-shopping-cart mr-3 text-gray-100 group-hover:text-white"></i>
            Job Card Management
          </a>
          <a href="Inventory Management.html" class="sidebar-link flex items-center px-4 py-3 text-gray-800 bg-white hover:bg-[#7F55B1] hover:text-white rounded-lg transition-colors group">
            <i class="fas fa-box mr-3 text-gray-400 group-hover:text-white"></i>
            Inventory Management
          </a>
          <a href="Invoice.html" class="sidebar-link flex items-center px-4 py-3 text-gray-800 bg-white hover:bg-[#7F55B1] hover:text-white rounded-lg transition-colors group">
            <i class="fas fa-file-invoice mr-3 text-gray-400 group-hover:text-white"></i>
            Billing Invoice
          </a>
          <a href="booking.html" class="sidebar-link flex items-center px-4 py-3 text-gray-800 bg-white hover:bg-[#7F55B1] hover:text-white rounded-lg transition-colors group">
            <i class="fas fa-calendar-check mr-3 text-gray-400 group-hover:text-white"></i>
            Appointment / Booking
          </a>
          <a href="staff-management.html" class="sidebar-link flex items-center px-4 py-3 text-gray-800 bg-white hover:bg-[#7F55B1] hover:text-white rounded-lg transition-colors group">
            <i class="fas fa-tools mr-3 text-gray-400 group-hover:text-white"></i>
            Mechanic/Staff Management
          </a>
          <a href="repoarts.html" class="sidebar-link flex items-center px-4 py-3 text-gray-800 bg-white hover:bg-[#7F55B1] hover:text-white rounded-lg transition-colors group">
            <i class="fas fa-chart-line mr-3 text-gray-400 group-hover:text-white"></i>
            Reports
          </a>
          <a href="Settings.html" class="sidebar-link flex items-center px-4 py-3 text-gray-800 bg-white hover:bg-[#7F55B1] hover:text-white rounded-lg transition-colors group">
            <i class="fas fa-cog mr-3 text-gray-400 group-hover:text-white"></i>
            Settings
          </a>
        </div>
      </nav>
    </div>

    <!-- Main Content -->
    <div class="lg:ml-64 flex flex-col min-h-screen">
        <!-- Top Header -->
        <header class="bg-white mt-1 shadow-sm border-b border-gray-200">
          <div class="px-4 sm:px-6 py-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
            
            <!-- Left Section -->
            <div class="flex items-center gap-4">
              <!-- Sidebar toggle for mobile -->
              <button id="sidebarToggle" class="lg:hidden p-2 text-gray-600 hover:bg-gray-100 rounded">
                <i class="fas fa-bars text-xl"></i>
              </button>
            </div>

            <!-- Right Section -->
            <div class="flex items-center space-x-4 w-full sm:w-auto">
              <!-- Search Input -->
              <div class="relative w-full sm:w-64">
                <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                <input type="text" placeholder="Search..." class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none">
              </div>

              <!-- Notification Icon -->
              <div class="relative">
                <button class="p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors">
                  <i class="fas fa-bell text-xl"></i>
                </button>
              </div>

              <!-- Profile Dropdown -->
              <div class="relative">
                <button id="profileButton" class="flex items-center space-x-2 p-2 hover:bg-gray-100 rounded-lg transition-colors focus:outline-none">
                  <img src="https://www.pngmart.com/files/21/Admin-Profile-Vector-PNG-Image.png" alt="Profile" class="w-8 h-8 rounded-full" />
                  <i class="fas fa-chevron-down text-gray-500"></i>
                </button>

                <!-- Dropdown Menu -->
                <div id="profileDropdown" class="hidden absolute right-0 mt-2 w-48 bg-white border border-gray-200 rounded-lg shadow-lg z-50">
                  <a href="#" class="block px-4 py-2 text-gray-700 hover:bg-gray-100">Profile</a>
                  <a href="index.html" class="block px-4 py-2 text-red-600 hover:bg-red-100">Logout</a>
                </div>
              </div>
            </div>
          </div>
        </header>

        <section class="p-6 md:p-10 bg-gray-100 min-h-screen">
          <div class="max-w-7xl mx-auto space-y-6">

            <!-- Header and Add Button -->
            <div class="flex justify-between items-center">
              <h2 class="text-2xl font-medium text-gray-800">Job Card Management</h2>
              <button onclick="toggleForm(true)" class="bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition">
                + Add Job Card
              </button>
            </div>

            <!-- Job Cards Table -->
            <div class="overflow-x-auto bg-white rounded-2xl shadow-lg">
              <table class="min-w-full divide-y divide-gray-200">
                <thead class="bg-purple-700 text-left text-sm font-medium text-gray-100">
                  <tr>
                    <th class="px-6 py-3">Job No.</th>
                    <th class="px-6 py-3">Customer</th>
                    <th class="px-6 py-3">Vehicle</th>
                    <th class="px-6 py-3">Date In</th>
                    <th class="px-6 py-3">Status</th>
                    <th class="px-6 py-3 text-center">Actions</th>
                  </tr>
                </thead>
                <tbody class="text-sm text-gray-700 divide-y divide-gray-100" id="jobTableBody">
                  <!-- Dynamic rows will be inserted here -->
                </tbody>
              </table>
            </div>

            <!-- Job Card Details Viewer -->
            <div id="jobDetails" class="hidden bg-white p-6 rounded-2xl shadow-lg">
              <div class="flex justify-between items-center mb-4">
                <h2 class="text-2xl font-bold text-gray-800">Job Card Details</h2>
                <button onclick="closeDetails()" class="text-sm text-gray-500 hover:underline">Close</button>
              </div>
              <div id="jobDetailsContent" class="job-card">
                <!-- Content will be inserted here -->
              </div>
            </div>

          </div>

          <!-- Modal for Job Card Form -->
          <div id="jobFormModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center">
            <div class="bg-white max-h-[80vh] w-full max-w-4xl rounded-2xl shadow-xl p-6 overflow-y-auto relative">
              <button onclick="toggleForm(false)" class="absolute top-2 right-2 text-gray-500 hover:text-gray-700 text-xl">&times;</button>

              <h2 class="text-2xl font-bold text-gray-800 mb-6">Create Job Card</h2>

              <form id="jobCardForm" class="space-y-6">
                <div class="grid md:grid-cols-2 gap-6">
                  <!-- Left Column -->
                  <div class="space-y-4">
                    <div>
                      <label class="block text-sm font-medium text-gray-700 mb-1">Job No.</label>
                      <input name="jobNo" type="text" class="w-full border border-gray-300 rounded-lg p-2" />
                    </div>
                    
                    <div>
                      <label class="block text-sm font-medium text-gray-700 mb-1">Job Date</label>
                      <input name="jobDate" type="date" class="w-full border border-gray-300 rounded-lg p-2" />
                    </div>
                    
                    <div>
                      <label class="block text-sm font-medium text-gray-700 mb-1">Car Registration No.</label>
                      <input name="regNo" type="text" class="w-full border border-gray-300 rounded-lg p-2" />
                    </div>
                    
                    <div>
                      <label class="block text-sm font-medium text-gray-700 mb-1">Year</label>
                      <input name="year" type="text" class="w-full border border-gray-300 rounded-lg p-2" />
                    </div>
                    
                    <div>
                      <label class="block text-sm font-medium text-gray-700 mb-1">Mileage</label>
                      <input name="mileage" type="text" class="w-full border border-gray-300 rounded-lg p-2" />
                    </div>
                    
                    <div>
                      <label class="block text-sm font-medium text-gray-700 mb-1">Date/Time In</label>
                      <input name="dateIn" type="datetime-local" class="w-full border border-gray-300 rounded-lg p-2" />
                    </div>
                    
                    <div>
                      <label class="block text-sm font-medium text-gray-700 mb-1">Date/Time Out</label>
                      <input name="dateOut" type="datetime-local" class="w-full border border-gray-300 rounded-lg p-2" />
                    </div>
                  </div>

                  <!-- Right Column -->
                  <div class="space-y-4">
                    <div>
                      <label class="block text-sm font-medium text-gray-700 mb-1">Car Make</label>
                      <input name="make" type="text" class="w-full border border-gray-300 rounded-lg p-2" />
                    </div>
                    
                    <div>
                      <label class="block text-sm font-medium text-gray-700 mb-1">Car Model</label>
                      <input name="model" type="text" class="w-full border border-gray-300 rounded-lg p-2" />
                    </div>
                    
                    <div>
                      <label class="block text-sm font-medium text-gray-700 mb-1">Customer Name</label>
                      <input name="customer" type="text" class="w-full border border-gray-300 rounded-lg p-2" />
                    </div>
                    
                    <div>
                      <label class="block text-sm font-medium text-gray-700 mb-1">Customer Contact No.</label>
                      <input name="contact" type="text" class="w-full border border-gray-300 rounded-lg p-2" />
                    </div>
                    
                    <div>
                      <label class="block text-sm font-medium text-gray-700 mb-1">Engine No.</label>
                      <input name="engineNo" type="text" class="w-full border border-gray-300 rounded-lg p-2" />
                    </div>
                    
                    <div>
                      <label class="block text-sm font-medium text-gray-700 mb-1">VIN No.</label>
                      <input name="vinNo" type="text" class="w-full border border-gray-300 rounded-lg p-2" />
                    </div>
                  </div>
                </div>

                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">Reported Defect</label>
                  <textarea name="defect" rows="3" class="w-full border border-gray-300 rounded-lg p-2"></textarea>
                </div>

                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">Vehicle Body Report (Mark with X where damage)</label>
                  <textarea name="bodyReport" rows="3" class="w-full border border-gray-300 rounded-lg p-2" placeholder="Describe damage locations..."></textarea>
                </div>

                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">Complete Action</label>
                  <textarea name="completeAction" rows="3" class="w-full border border-gray-300 rounded-lg p-2"></textarea>
                </div>

                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">Vehicle Body Report Comments</label>
                  <textarea name="bodyComments" rows="2" class="w-full border border-gray-300 rounded-lg p-2"></textarea>
                </div>

                <div class="border-t pt-4">
                  <h3 class="font-medium mb-2">Parts Used</h3>
                  <table class="w-full border border-gray-300">
                    <thead>
                      <tr class="bg-gray-100">
                        <th class="p-2 border">Part No.</th>
                        <th class="p-2 border">Part Description</th>
                        <th class="p-2 border">Qty</th>
                        <th class="p-2 border">Unit Price</th>
                        <th class="p-2 border">Line Total</th>
                      </tr>
                    </thead>
                    <tbody id="partsTable">
                      <tr>
                        <td class="p-2 border"><input type="text" name="partNo[]" class="w-full p-1 border rounded"></td>
                        <td class="p-2 border"><input type="text" name="partDesc[]" class="w-full p-1 border rounded"></td>
                        <td class="p-2 border"><input type="number" name="partQty[]" class="w-full p-1 border rounded"></td>
                        <td class="p-2 border"><input type="number" name="partPrice[]" class="w-full p-1 border rounded"></td>
                        <td class="p-2 border"><input type="number" name="partTotal[]" class="w-full p-1 border rounded" readonly></td>
                      </tr>
                    </tbody>
                  </table>
                  <button type="button" onclick="addPartRow()" class="mt-2 text-sm text-indigo-600 hover:underline">+ Add Part</button>
                </div>

                <div class="grid md:grid-cols-2 gap-4 mt-4">
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Labour Charges</label>
                    <input name="labour" type="number" class="w-full border border-gray-300 rounded-lg p-2" />
                  </div>
                  
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Sub Total</label>
                    <input name="subTotal" type="number" class="w-full border border-gray-300 rounded-lg p-2" readonly />
                  </div>
                  
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">VAT</label>
                    <input name="vat" type="number" class="w-full border border-gray-300 rounded-lg p-2" />
                  </div>
                  
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">TOTAL</label>
                    <input name="total" type="number" class="w-full border border-gray-300 rounded-lg p-2" readonly />
                  </div>
                </div>

                <div class="grid md:grid-cols-2 gap-4 mt-4">
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Technical Name</label>
                    <input name="techName" type="text" class="w-full border border-gray-300 rounded-lg p-2" />
                  </div>
                  
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Status</label>
                    <select name="status" class="w-full border border-gray-300 rounded-lg p-2">
                      <option>Received</option>
                      <option>Diagnosing</option>
                      <option>In Repair</option>
                      <option>Ready</option>
                      <option>Delivered</option>
                    </select>
                  </div>
                </div>

                <div class="text-right pt-4">
                  <button type="submit" class="bg-indigo-600 text-white px-6 py-2 rounded-lg hover:bg-indigo-700 transition">
                    Save Job Card
                  </button>
                </div>
              </form>
            </div>
          </div>
        </section>
    </div>

    <!-- JavaScript -->
    <script>
      // Sample data for demonstration
      let jobCards = [
        {
          jobNo: "JC-001",
          jobDate: "2023-05-15",
          regNo: "TN-09-AB-1234",
          year: "2019",
          mileage: "45,000",
          dateIn: "2023-05-15T10:00",
          dateOut: "2023-05-17T16:00",
          make: "Toyota",
          model: "Innova Crysta",
          customer: "Lokesh",
          contact: "9876543210",
          engineNo: "ENG123456",
          vinNo: "VIN987654",
          defect: "Engine noise, AC not cooling",
          bodyReport: "Front bumper scratch (X marked)",
          completeAction: "Replaced AC compressor, engine tuning",
          bodyComments: "Minor scratches, no structural damage",
          parts: [
            { partNo: "AC-123", description: "AC Compressor", qty: 1, price: 5000, total: 5000 },
            { partNo: "OIL-456", description: "Engine Oil", qty: 5, price: 300, total: 1500 }
          ],
          labour: 1500,
          subTotal: 8000,
          vat: 800,
          total: 8800,
          techName: "Rajesh",
          status: "Delivered"
        }
      ];

      // Initialize the table with sample data
      function initializeTable() {
        const tbody = document.getElementById("jobTableBody");
        tbody.innerHTML = "";
        
        jobCards.forEach((job, index) => {
          const row = document.createElement("tr");
          row.innerHTML = `
            <td class="px-6 py-4">${job.jobNo}</td>
            <td class="px-6 py-4">${job.customer}</td>
            <td class="px-6 py-4">${job.make} ${job.model}</td>
            <td class="px-6 py-4">${job.dateIn.split('T')[0]}</td>
            <td class="px-6 py-4">${job.status}</td>
            <td class="px-6 py-4 text-center space-x-2">
              <button onclick="viewJob(${index})" class="text-indigo-600 hover:underline">View</button>
              <button onclick="editJob(${index})" class="text-yellow-600 hover:underline">Edit</button>
              <button onclick="deleteJob(${index})" class="text-red-600 hover:underline">Delete</button>
            </td>
          `;
          tbody.appendChild(row);
        });
      }

      // View job card in detail
      function viewJob(index) {
        const job = jobCards[index];
        
        let partsHtml = "";
        if (job.parts && job.parts.length > 0) {
          partsHtml = job.parts.map(part => `
            <tr>
              <td>${part.partNo}</td>
              <td>${part.description}</td>
              <td>${part.qty}</td>
              <td>${part.price}</td>
              <td>${part.total}</td>
            </tr>
          `).join("");
        }
        
        const html = `
          <h1>VEHICLE JOB CARD</h1>
          
          <div class="grid-container">
            <div class="field">
              <label>Job No.</label>
              <span>${job.jobNo}</span>
            </div>
            <div class="field">
              <label>Job Date</label>
              <span>${job.jobDate}</span>
            </div>
            <div class="field">
              <label>Car Registration No.</label>
              <span>${job.regNo}</span>
            </div>
            <div class="field">
              <label>Year</label>
              <span>${job.year}</span>
            </div>
            <div class="field">
              <label>Mileage</label>
              <span>${job.mileage}</span>
            </div>
          </div>
          
          <div class="grid-container">
            <div class="field">
              <label>Date/Time In</label>
              <span>${job.dateIn.replace('T', ' ')}</span>
            </div>
            <div class="field">
              <label>Date/Time Out</label>
              <span>${job.dateOut.replace('T', ' ')}</span>
            </div>
            <div class="field">
              <label>Car Make</label>
              <span>${job.make}</span>
            </div>
            <div class="field">
              <label>Car Model</label>
              <span>${job.model}</span>
            </div>
          </div>
          
          <div class="grid-container">
            <div class="field">
              <label>Customer Name</label>
              <span>${job.customer}</span>
            </div>
            <div class="field">
              <label>Customer Contact No.</label>
              <span>${job.contact}</span>
            </div>
            <div class="field">
              <label>Engine No.</label>
              <span>${job.engineNo}</span>
            </div>
            <div class="field">
              <label>VIN No.</label>
              <span>${job.vinNo}</span>
            </div>
          </div>
          
          <div class="field">
            <label>Reported Defect</label>
            <div>${job.defect}</div>
          </div>
          
          <div class="body-report">
            <label>Vehicle Body Report (Mark with X where damage)</label>
            <div>${job.bodyReport}</div>
            <!-- Here you would normally have an image of the car with marks -->
          </div>
          
          <div class="field">
            <label>Complete Action</label>
            <div>${job.completeAction}</div>
          </div>
          
          <div class="field">
            <label>Vehicle Body Report Comments</label>
            <div>${job.bodyComments}</div>
          </div>
          
          <table>
            <thead>
              <tr>
                <th>Part No.</th>
                <th>Part Description</th>
                <th>Qty</th>
                <th>Unit Price</th>
                <th>Line Total</th>
              </tr>
            </thead>
            <tbody>
              ${partsHtml}
            </tbody>
          </table>
          
          <div style="display: flex; justify-content: space-between; margin-top: 20px;">
            <div>
              <div class="field">
                <label>Labour</label>
                <span>${job.labour}</span>
              </div>
            </div>
            <div>
              <div class="field">
                <label>Sub Total</label>
                <span>${job.subTotal}</span>
              </div>
              <div class="field">
                <label>VAT</label>
                <span>${job.vat}</span>
              </div>
              <div class="field">
                <label>TOTAL</label>
                <span>${job.total}</span>
              </div>
            </div>
          </div>
          
          <div style="display: flex; justify-content: space-between; margin-top: 30px;">
            <div class="signature-box">
              <label>Technical Name</label>
              <div>${job.techName}</div>
            </div>
            <div class="signature-box">
              <label>Technician Signature</label>
              <div style="height: 30px;"></div>
            </div>
            <div class="signature-box">
              <label>Date</label>
              <div>${new Date().toLocaleDateString()}</div>
            </div>
          </div>
          
          <div class="footer">
            <p>The user at invoice, all estimates are valid for 30 days</p>
            <p>Images may be subject to copyright. Learn More</p>
          </div>
        `;
        
        document.getElementById('jobDetailsContent').innerHTML = html;
        document.getElementById('jobDetails').classList.remove('hidden');
        window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
      }

      function closeDetails() {
        document.getElementById('jobDetails').classList.add('hidden');
      }

      function toggleForm(show) {
        const modal = document.getElementById('jobFormModal');
        modal.classList.toggle('hidden', !show);
        if (!show) document.getElementById("jobCardForm").reset();
        closeDetails();
      }

      function addPartRow() {
        const tbody = document.getElementById("partsTable");
        const row = document.createElement("tr");
        row.innerHTML = `
          <td class="p-2 border"><input type="text" name="partNo[]" class="w-full p-1 border rounded"></td>
          <td class="p-2 border"><input type="text" name="partDesc[]" class="w-full p-1 border rounded"></td>
          <td class="p-2 border"><input type="number" name="partQty[]" class="w-full p-1 border rounded"></td>
          <td class="p-2 border"><input type="number" name="partPrice[]" class="w-full p-1 border rounded"></td>
          <td class="p-2 border"><input type="number" name="partTotal[]" class="w-full p-1 border rounded" readonly></td>
        `;
        tbody.appendChild(row);
      }

      function editJob(index) {
        // In a real app, you would populate the form with the job data
        toggleForm(true);
        // Here you would set all the form values from jobCards[index]
        alert("Edit functionality would populate the form with job #" + (index + 1));
      }

      function deleteJob(index) {
        if (confirm("Are you sure you want to delete this job card?")) {
          jobCards.splice(index, 1);
          initializeTable();
          closeDetails();
        }
      }

      // Handle form submission
      document.addEventListener("DOMContentLoaded", () => {
        initializeTable();
        
        const form = document.getElementById("jobCardForm");
        form.addEventListener("submit", function(e) {
          e.preventDefault();
          
          // In a real app, you would collect all form data here
          const newJob = {
            jobNo: form.jobNo.value,
            jobDate: form.jobDate.value,
            regNo: form.regNo.value,
            year: form.year.value,
            mileage: form.mileage.value,
            dateIn: form.dateIn.value,
            dateOut: form.dateOut.value,
            make: form.make.value,
            model: form.model.value,
            customer: form.customer.value,
            contact: form.contact.value,
            engineNo: form.engineNo.value,
            vinNo: form.vinNo.value,
            defect: form.defect.value,
            bodyReport: form.bodyReport.value,
            completeAction: form.completeAction.value,
            bodyComments: form.bodyComments.value,
            parts: [], // You would collect parts data here
            labour: form.labour.value,
            subTotal: form.subTotal.value,
            vat: form.vat.value,
            total: form.total.value,
            techName: form.techName.value,
            status: form.status.value
          };
          
          // Add to our array and refresh table
          jobCards.push(newJob);
          initializeTable();
          toggleForm(false);
        });
        
        // Sidebar toggle
        const sidebar = document.getElementById('sidebar');
        document.getElementById('sidebarToggle').addEventListener('click', () => {
            sidebar.classList.toggle('-translate-x-full');
        });

        document.getElementById('sidebarClose').addEventListener('click', () => {
            sidebar.classList.add('-translate-x-full');
        });
        
        // Profile dropdown
        const profileBtn = document.getElementById('profileButton');
        const dropdown = document.getElementById('profileDropdown');

        profileBtn.addEventListener('click', () => {
          dropdown.classList.toggle('hidden');
        });

        // Close on outside click
        document.addEventListener('click', (e) => {
          if (!profileBtn.contains(e.target) && !dropdown.contains(e.target)) {
            dropdown.classList.add('hidden');
          }
        });
      });
    </script>
</body>
</html>